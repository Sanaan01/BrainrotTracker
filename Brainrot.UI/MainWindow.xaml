<Window
    x:Class="Brainrot.UI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="using:Brainrot.UI"
    mc:Ignorable="d"
    Title="Brainrot Tracker">

    <Grid Background="{ThemeResource AppBackgroundBrush}">
        <!-- custom button template lives here, NOT on <Window> -->
        <Grid.Resources>
            <Style x:Key="QuickCategoryButtonStyle" TargetType="Button">
                <Setter Property="Padding" Value="12,8" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="8">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Title bar region (draggable) -->
        <Grid x:Name="TitleBarHost"
              Grid.Row="0"
              Background="{ThemeResource AppBackgroundBrush}"
              Padding="24,24,24,16">
            <StackPanel Spacing="4">
                <TextBlock Text="Brainrot Tracker"
                           FontSize="24"
                           FontWeight="SemiBold" />
                <TextBlock Text="Monitor your digital wellbeing and app usage"
                           FontSize="12"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
            </StackPanel>
        </Grid>

        <!-- Main content -->
        <ScrollViewer Grid.Row="1"
                      HorizontalScrollMode="Disabled"
                      VerticalScrollMode="Auto"
                      VerticalScrollBarVisibility="Auto">
            <StackPanel Padding="24,0,24,24" Spacing="24">

                <!-- Top grid: summary + brain health + quick categorize -->
                <Grid ColumnSpacing="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2.2*" />
                        <ColumnDefinition Width="3*" />
                        <ColumnDefinition Width="2.5*" />
                    </Grid.ColumnDefinitions>

                    <!-- Summary cards -->
                    <StackPanel Spacing="10">
                        <Border Background="{ThemeResource CardBackgroundBrush}"
                                Padding="16"
                                CornerRadius="16"
                                BorderBrush="{ThemeResource CardStrokeBrush}"
                                BorderThickness="1">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Total Active Time" FontWeight="SemiBold" />
                                <TextBlock x:Name="TotalTimeText"
                                           Text="0m 00s"
                                           FontSize="22"
                                           FontWeight="SemiBold" />
                                <TextBlock Text="Focus, rot, and neutral combined"
                                           FontSize="12"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                            </StackPanel>
                        </Border>

                        <Grid ColumnSpacing="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <Border Background="{ThemeResource FocusCardBackgroundBrush}"
                                    CornerRadius="14"
                                    Padding="12"
                                    BorderBrush="{ThemeResource FocusCardStrokeBrush}"
                                    BorderThickness="1">
                                <StackPanel>
                                    <TextBlock Text="Focus Time" FontWeight="SemiBold" />
                                    <TextBlock x:Name="FocusText"
                                               Text="0m 00s"
                                               FontSize="20"
                                               FontWeight="SemiBold" />
                                    <TextBlock Text="Getting things done"
                                               FontSize="12"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="1"
                                    Background="{ThemeResource RotCardBackgroundBrush}"
                                    CornerRadius="14"
                                    Padding="12"
                                    BorderBrush="{ThemeResource RotCardStrokeBrush}"
                                    BorderThickness="1">
                                <StackPanel>
                                    <TextBlock Text="Rot Time" FontWeight="SemiBold" />
                                    <TextBlock x:Name="RotText"
                                               Text="0m 00s"
                                               FontSize="20"
                                               FontWeight="SemiBold" />
                                    <TextBlock Text="Distractions &amp; doomscrolling"
                                               FontSize="12"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                            </Border>
                        </Grid>

                        <Border Background="{ThemeResource NeutralCardBackgroundBrush}"
                                CornerRadius="14"
                                Padding="12"
                                BorderBrush="{ThemeResource NeutralCardStrokeBrush}"
                                BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="Neutral Time" FontWeight="SemiBold" />
                                <TextBlock x:Name="NeutralText"
                                           Text="0m 00s"
                                           FontSize="20"
                                           FontWeight="SemiBold" />
                                <TextBlock Text="Meetings, idle, misc."
                                           FontSize="12"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Brain health -->
                    <Border Grid.Column="1"
                            Background="{ThemeResource CardBackgroundBrush}"
                            Padding="18"
                            CornerRadius="16"
                            BorderBrush="{ThemeResource CardStrokeBrush}"
                            BorderThickness="1">
                        <Grid ColumnSpacing="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <!-- Avatar with emoji inside -->
                            <Grid Width="140"
                                  Height="140"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center">
                                <Ellipse Width="120"
                                         Height="120"
                                         Fill="{ThemeResource CardSubtleFillColorDefaultBrush}"
                                         Stroke="{ThemeResource CardStrokeBrush}"
                                         StrokeThickness="2" />
                                <TextBlock x:Name="EmojiText"
                                           Text="ðŸ’€"
                                           FontSize="48"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center" />
                            </Grid>

                            <StackPanel Grid.Column="1"
                                        Spacing="8"
                                        VerticalAlignment="Center">
                                <TextBlock Text="Brain Health"
                                           FontSize="12"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                <TextBlock x:Name="BrainStateText"
                                           Text="Full brainrot"
                                           FontSize="26"
                                           FontWeight="SemiBold" />
                                <TextBlock x:Name="FocusVsRotLabel"
                                           Text="0% focus"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                <ProgressBar x:Name="FocusVsRotBar"
                                             Minimum="0"
                                             Maximum="100"
                                             Value="0"
                                             Height="10"
                                             CornerRadius="8" />
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Quick categorize -->
                    <Border Grid.Column="2"
                            Background="{ThemeResource CardBackgroundBrush}"
                            Padding="18"
                            CornerRadius="16"
                            BorderBrush="{ThemeResource CardStrokeBrush}"
                            BorderThickness="1">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Quick Categorize"
                                       FontSize="18"
                                       FontWeight="SemiBold" />
                            <TextBlock x:Name="CategoryStatusText"
                                       Text="Select an app from Category breakdown"
                                       FontSize="12"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" />

                            <!-- Selected app card -->
                            <Border x:Name="SelectedAppCard"
                                    Background="{ThemeResource NeutralPillBackgroundBrush}"
                                    BorderBrush="{ThemeResource NeutralPillStrokeBrush}"
                                    BorderThickness="1.5"
                                    CornerRadius="10"
                                    Padding="12"
                                    Visibility="Collapsed">
                                <StackPanel>
                                    <TextBlock x:Name="SelectedAppNameText"
                                               FontWeight="SemiBold"
                                               FontSize="14" />
                                    <TextBlock x:Name="SelectedAppDurationText"
                                               FontSize="11"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>
                            </Border>

                            <StackPanel Spacing="8">
                                <Button x:Name="FocusButton"
                                        Style="{StaticResource QuickCategoryButtonStyle}"
                                        Click="CategoryButton_Focus"
                                        Background="{ThemeResource FocusPillBackgroundBrush}"
                                        BorderBrush="{ThemeResource FocusPillStrokeBrush}"
                                        BorderThickness="1"
                                        IsEnabled="False"
                                        PointerEntered="QuickCategoryButton_PointerEntered"
                                        PointerExited="QuickCategoryButton_PointerExited">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE73E;" FontSize="16" />
                                        <TextBlock Text="Focus" />
                                    </StackPanel>
                                </Button>

                                <Button x:Name="NeutralButton"
                                        Style="{StaticResource QuickCategoryButtonStyle}"
                                        Click="CategoryButton_Neutral"
                                        Background="{ThemeResource NeutralPillBackgroundBrush}"
                                        BorderBrush="{ThemeResource NeutralPillStrokeBrush}"
                                        BorderThickness="1"
                                        IsEnabled="False"
                                        PointerEntered="QuickCategoryButton_PointerEntered"
                                        PointerExited="QuickCategoryButton_PointerExited">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8BF;" FontSize="16" />
                                        <TextBlock Text="Neutral" />
                                    </StackPanel>
                                </Button>

                                <Button x:Name="RotButton"
                                        Style="{StaticResource QuickCategoryButtonStyle}"
                                        Click="CategoryButton_Rot"
                                        Background="{ThemeResource RotPillBackgroundBrush}"
                                        BorderBrush="{ThemeResource RotPillStrokeBrush}"
                                        BorderThickness="1"
                                        IsEnabled="False"
                                        PointerEntered="QuickCategoryButton_PointerEntered"
                                        PointerExited="QuickCategoryButton_PointerExited">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE7BA;" FontSize="16" />
                                        <TextBlock Text="Rot" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Bottom grid: category breakdown + per-app -->
                <Grid ColumnSpacing="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2.5*" />
                        <ColumnDefinition Width="3.5*" />
                    </Grid.ColumnDefinitions>

                    <!-- Category breakdown -->
                    <Border Grid.Column="0"
                            Background="{ThemeResource CardBackgroundBrush}"
                            Padding="18"
                            CornerRadius="16"
                            BorderBrush="{ThemeResource CardStrokeBrush}"
                            BorderThickness="1">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Category breakdown"
                                       FontSize="18"
                                       FontWeight="SemiBold" />
                            <TextBlock Text="Manage the lists that define your rot, focus, and neutral apps."
                                       FontSize="12"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" />

                            <Grid ColumnSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <!-- Rot apps -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="Rot apps" FontWeight="SemiBold" />
                                    <ItemsControl x:Name="RotAppsList">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{ThemeResource RotPillBackgroundBrush}"
                                                        BorderBrush="{ThemeResource RotPillStrokeBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="8"
                                                        Padding="10,6"
                                                        Margin="0,0,0,6"
                                                        Tapped="CategoryBreakdownItem_Tapped"
                                                        PointerEntered="CategoryBreakdownItem_PointerEntered"
                                                        PointerExited="CategoryBreakdownItem_PointerExited">
                                                    <TextBlock Text="{Binding}" />
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>

                                <!-- Focus apps -->
                                <StackPanel Grid.Column="1" Spacing="6">
                                    <TextBlock Text="Focus apps" FontWeight="SemiBold" />
                                    <ItemsControl x:Name="FocusAppsList">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{ThemeResource FocusPillBackgroundBrush}"
                                                        BorderBrush="{ThemeResource FocusPillStrokeBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="8"
                                                        Padding="10,6"
                                                        Margin="0,0,0,6"
                                                        Tapped="CategoryBreakdownItem_Tapped"
                                                        PointerEntered="CategoryBreakdownItem_PointerEntered"
                                                        PointerExited="CategoryBreakdownItem_PointerExited">
                                                    <TextBlock Text="{Binding}" />
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>

                                <!-- Neutral apps -->
                                <StackPanel Grid.Column="2" Spacing="6">
                                    <TextBlock Text="Neutral apps" FontWeight="SemiBold" />
                                    <ItemsControl x:Name="NeutralAppsList">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{ThemeResource NeutralPillBackgroundBrush}"
                                                        BorderBrush="{ThemeResource NeutralPillStrokeBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="8"
                                                        Padding="10,6"
                                                        Margin="0,0,0,6"
                                                        Tapped="CategoryBreakdownItem_Tapped"
                                                        PointerEntered="CategoryBreakdownItem_PointerEntered"
                                                        PointerExited="CategoryBreakdownItem_PointerExited">
                                                    <TextBlock Text="{Binding}" />
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Per-app usage -->
                    <Border Grid.Column="1"
                            Background="{ThemeResource CardBackgroundBrush}"
                            Padding="18"
                            CornerRadius="16"
                            BorderBrush="{ThemeResource CardStrokeBrush}"
                            BorderThickness="1">
                        <Grid RowSpacing="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <TextBlock Text="Per-app usage"
                                       FontSize="18"
                                       FontWeight="SemiBold" />

                            <ListView x:Name="AppsList"
                                      Grid.Row="1"
                                      BorderThickness="0"
                                      SelectionMode="None">
                                <ListView.Header>
                                    <Grid Padding="6,2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Text="App"
                                                   FontWeight="SemiBold" />
                                        <TextBlock Text="Duration"
                                                   Grid.Column="1"
                                                   FontWeight="SemiBold" />
                                        <TextBlock Text="Category"
                                                   Grid.Column="2"
                                                   FontWeight="SemiBold" />
                                    </Grid>
                                </ListView.Header>

                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="6,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Text="{Binding AppName}" />
                                            <TextBlock Grid.Column="1" Text="{Binding Duration}" />
                                            <TextBlock Grid.Column="2" Text="{Binding Category}" />
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Border>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
